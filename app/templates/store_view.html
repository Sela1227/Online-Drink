{% extends "base.html" %}

{% block title %}{{ store.name }} - SELA å¿«é»ä¾†é»é¤{% endblock %}

{% block content %}
<div class="space-y-4">
    <!-- Header -->
    <div>
        <a href="/home" class="text-sm text-gray-500 hover:text-gray-700">â† è¿”å›é¦–é </a>
    </div>
    
    <!-- åº—å®¶è³‡è¨Šå¡ç‰‡ -->
    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
        <!-- é ‚éƒ¨ï¼šLogo + åŸºæœ¬è³‡è¨Š -->
        <div class="p-5 flex items-start gap-4">
            <div class="w-20 h-20 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl flex items-center justify-center flex-shrink-0 overflow-hidden">
                {% if store.logo_url %}
                <img src="{{ store.logo_url }}" alt="{{ store.name }}" class="w-full h-full object-contain p-2">
                {% else %}
                <span class="text-4xl">
                    {% if store.category and store.category.value == 'drink' %}ğŸ§‹
                    {% elif store.category and store.category.value == 'group_buy' %}ğŸ›’
                    {% else %}ğŸ±{% endif %}
                </span>
                {% endif %}
            </div>
            <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 flex-wrap">
                    <h1 class="text-xl font-bold text-gray-800">{{ store.name }}</h1>
                    <span class="text-xs px-2 py-0.5 bg-gray-100 rounded">
                        {% if store.category and store.category.value == 'drink' %}ğŸ§‹ é£²æ–™åº—
                        {% elif store.category and store.category.value == 'group_buy' %}ğŸ›’ åœ˜è³¼
                        {% else %}ğŸ± é¤å»³{% endif %}
                    </span>
                </div>
                {% if store.branches %}
                <div class="text-sm text-gray-500 mt-1">{{ store.branches|length }} é–“åˆ†åº—</div>
                {% endif %}
                
                <!-- æ”¶è—æŒ‰éˆ• -->
                <div class="mt-3">
                    {% if is_favorited %}
                    <form action="/favorites/{{ store.id }}/remove" method="post" class="inline">
                        <button type="submit" class="text-sm px-3 py-1.5 bg-orange-100 text-orange-600 rounded-full hover:bg-orange-200">
                            â­ å·²æ”¶è—
                        </button>
                    </form>
                    {% else %}
                    <form action="/favorites/{{ store.id }}/add" method="post" class="inline">
                        <button type="submit" class="text-sm px-3 py-1.5 bg-gray-100 text-gray-600 rounded-full hover:bg-gray-200">
                            â˜† æ”¶è—åº—å®¶
                        </button>
                    </form>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- è¯çµ¡è³‡è¨Š -->
        {% if store.phone or store.address %}
        <div class="px-5 pb-4 space-y-2 border-t pt-4">
            {% if store.phone %}
            <div class="flex items-center gap-3 text-sm">
                <span class="w-6 text-center">ğŸ“</span>
                <a href="tel:{{ store.phone }}" class="text-blue-600 hover:underline">{{ store.phone }}</a>
            </div>
            {% endif %}
            {% if store.address %}
            <div class="flex items-center gap-3 text-sm">
                <span class="w-6 text-center">ğŸ“</span>
                <span class="text-gray-600">{{ store.address }}</span>
            </div>
            {% endif %}
        </div>
        {% endif %}
        
        <!-- å¤–éƒ¨é€£çµ -->
        {% if store.website_url or store.google_maps_url or store.ubereats_url or store.foodpanda_url %}
        <div class="px-5 pb-5 flex flex-wrap gap-2">
            {% if store.website_url %}
            <a href="{{ store.website_url }}" target="_blank"
               class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-sm hover:bg-gray-200">
                ğŸŒ å®˜ç¶²
            </a>
            {% endif %}
            {% if store.google_maps_url %}
            <a href="{{ store.google_maps_url }}" target="_blank"
               class="px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg text-sm hover:bg-blue-100">
                ğŸ—ºï¸ Google Maps
            </a>
            {% endif %}
            {% if store.ubereats_url %}
            <a href="{{ store.ubereats_url }}" target="_blank"
               class="px-3 py-1.5 bg-green-50 text-green-700 rounded-lg text-sm hover:bg-green-100">
                ğŸŸ¢ Uber Eats
            </a>
            {% endif %}
            {% if store.foodpanda_url %}
            <a href="{{ store.foodpanda_url }}" target="_blank"
               class="px-3 py-1.5 bg-pink-50 text-pink-700 rounded-lg text-sm hover:bg-pink-100">
                ğŸ©· foodpanda
            </a>
            {% endif %}
        </div>
        {% endif %}
    </div>
    
    <!-- é£²æ–™åº—é¸é … -->
    {% if store.category and store.category.value == 'drink' and store.options %}
    <div class="bg-white rounded-xl shadow-sm p-4">
        <h2 class="font-semibold text-gray-800 mb-3">ğŸ¥¤ ç”œåº¦/å†°å¡Š</h2>
        <div class="grid grid-cols-2 gap-3 text-sm">
            <div>
                <div class="text-gray-500 mb-1.5">ç”œåº¦</div>
                <div class="flex flex-wrap gap-1">
                    {% for opt in store.options if opt.option_type.value == 'sugar' %}
                    <span class="px-2 py-0.5 bg-amber-50 text-amber-700 rounded text-xs">{{ opt.option_value }}</span>
                    {% endfor %}
                </div>
            </div>
            <div>
                <div class="text-gray-500 mb-1.5">å†°å¡Š</div>
                <div class="flex flex-wrap gap-1">
                    {% for opt in store.options if opt.option_type.value == 'ice' %}
                    <span class="px-2 py-0.5 bg-blue-50 text-blue-700 rounded text-xs">{{ opt.option_value }}</span>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- åŠ æ–™é¸é … -->
    {% if store.toppings %}
    <div class="bg-white rounded-xl shadow-sm p-4">
        <h2 class="font-semibold text-gray-800 mb-3">ğŸ§‹ åŠ æ–™é¸é …</h2>
        <div class="flex flex-wrap gap-2">
            {% for topping in store.toppings|sort(attribute='sort_order') if topping.is_active %}
            <span class="px-2.5 py-1 bg-orange-50 text-orange-700 rounded-lg text-sm">
                {{ topping.name }} +${{ topping.price|int }}
            </span>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- åˆ†åº—åˆ—è¡¨ -->
    {% if store.branches %}
    <div class="bg-white rounded-xl shadow-sm p-4">
        <h2 class="font-semibold text-gray-800 mb-3">ğŸª åˆ†åº— ({{ store.branches|length }})</h2>
        <div class="space-y-2">
            {% for branch in store.branches %}
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                    <div class="font-medium text-gray-800">{{ branch.name }}</div>
                    {% if branch.phone %}
                    <a href="tel:{{ branch.phone }}" class="text-sm text-blue-600 hover:underline">ğŸ“ {{ branch.phone }}</a>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- ç›®å‰é–‹æ”¾çš„åœ˜å–® -->
    {% if active_groups %}
    <div class="bg-white rounded-xl shadow-sm p-4">
        <h2 class="font-semibold text-gray-800 mb-3">ğŸ”¥ ç›®å‰é–‹æ”¾çš„åœ˜</h2>
        <div class="space-y-2">
            {% for group in active_groups %}
            <a href="/groups/{{ group.id }}" class="block p-3 bg-orange-50 rounded-lg hover:bg-orange-100 transition">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="font-medium text-gray-800">{{ group.name }}</div>
                        <div class="text-xs text-gray-500">
                            {{ group.owner.show_name }} é–‹åœ˜ Â· 
                            {% if group.orders %}{{ group.orders|length }}{% else %}0{% endif %} äººåƒåŠ 
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm text-orange-600 font-medium">
                            {{ group.deadline.strftime('%H:%M') }} æˆªæ­¢
                        </div>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- å¿«é€Ÿé–‹åœ˜æŒ‰éˆ• -->
    <div class="fixed bottom-20 left-0 right-0 px-4 max-w-lg mx-auto">
        <a href="/groups/new?store_id={{ store.id }}" 
           class="block w-full py-3 bg-orange-500 hover:bg-orange-600 text-white text-center rounded-xl font-medium shadow-lg">
            ğŸš€ ç”¨é€™é–“åº—é–‹åœ˜
        </a>
    </div>
    
    <!-- åº•éƒ¨ç•™ç™½ -->
    <div class="h-16"></div>
</div>
{% endblock %}
