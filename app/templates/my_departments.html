{% extends "base.html" %}

{% block title %}æˆ‘çš„éƒ¨é–€ - SELA å¿«é»ä¾†é»é¤{% endblock %}

{% block content %}
<div class="space-y-4">
    <!-- æ¨™é¡Œåˆ— -->
    <div class="flex items-center justify-between">
        <h1 class="text-xl font-bold text-gray-800">ğŸ‘¥ æˆ‘çš„éƒ¨é–€</h1>
        <a href="/profile" class="text-sm text-gray-500 hover:text-gray-700">è¿”å›å€‹äººé é¢ â†’</a>
    </div>
    
    {% if request.query_params.get('success') %}
    <div class="bg-green-50 text-green-700 px-4 py-3 rounded-lg">
        âœ… å·²æ›´æ–°éƒ¨é–€è¨­å®š
    </div>
    {% endif %}
    
    <!-- å·²åŠ å…¥çš„éƒ¨é–€ -->
    <div class="bg-white rounded-lg shadow-sm p-4">
        <h2 class="font-medium text-gray-800 mb-3">å·²åŠ å…¥çš„éƒ¨é–€</h2>
        
        {% if my_departments %}
        <div class="space-y-2">
            {% for ud in my_departments %}
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                    <span class="font-medium text-gray-800">{{ ud.department.name }}</span>
                    {% if ud.role.value == 'leader' %}
                    <span class="text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded ml-2">å°çµ„é•·</span>
                    {% endif %}
                </div>
                <form action="/my-departments/{{ ud.department_id }}/leave" method="POST"
                      onsubmit="return confirm('ç¢ºå®šè¦é›¢é–‹æ­¤éƒ¨é–€ï¼Ÿ')">
                    <button type="submit" class="text-sm text-red-500 hover:text-red-600">é€€å‡º</button>
                </form>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-gray-500 text-sm">å°šæœªåŠ å…¥ä»»ä½•éƒ¨é–€</p>
        {% endif %}
    </div>
    
    <!-- å¯åŠ å…¥çš„éƒ¨é–€ -->
    {% if available_departments %}
    <div class="bg-white rounded-lg shadow-sm p-4">
        <h2 class="font-medium text-gray-800 mb-3">å¯åŠ å…¥çš„éƒ¨é–€</h2>
        <div class="space-y-2">
            {% for dept in available_departments %}
            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                    <span class="font-medium text-gray-800">{{ dept.name }}</span>
                    {% if dept.description %}
                    <p class="text-xs text-gray-500 mt-1">{{ dept.description }}</p>
                    {% endif %}
                    <p class="text-xs text-gray-400 mt-1">{{ dept.member_count }} ä½æˆå“¡</p>
                </div>
                <form action="/my-departments/{{ dept.id }}/join" method="POST">
                    <button type="submit" class="text-sm bg-orange-500 text-white px-3 py-1 rounded hover:bg-orange-600">
                        åŠ å…¥
                    </button>
                </form>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <div class="text-center text-sm text-gray-400 py-4">
        ğŸ’¡ éƒ¨é–€åŠŸèƒ½å¯è®“åœ˜å–®åªé¡¯ç¤ºçµ¦ç‰¹å®šéƒ¨é–€çš„äºº
    </div>
</div>
{% endblock %}
