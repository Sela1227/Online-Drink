{% extends "base.html" %}

{% block title %}åŒ¯å…¥é è¦½ - åœ˜è³¼ç³»çµ±{% endblock %}

{% block content %}
<div class="space-y-4">
    <div class="flex items-center justify-between">
        <h1 class="text-xl font-bold text-gray-800">åŒ¯å…¥é è¦½</h1>
        <a href="/admin/import" class="text-gray-500 hover:text-gray-700">â† è¿”å›</a>
    </div>
    
    <!-- åŒ¯å…¥é¡å‹ -->
    <div class="bg-white rounded-lg shadow-sm p-4">
        {% if is_full_import %}
        <div class="text-sm text-indigo-600 font-medium mb-2">ğŸ“¦ å®Œæ•´åŒ¯å…¥ï¼ˆæ–°åº—å®¶ + èœå–®ï¼‰</div>
        
        <!-- åº—å®¶è³‡è¨Š -->
        <div class="border rounded-lg p-3 mb-4">
            <h3 class="font-medium text-gray-800">åº—å®¶è³‡è¨Š</h3>
            <div class="mt-2 text-sm text-gray-600 space-y-1">
                <div>åç¨±ï¼š<span class="font-medium">{{ data.store.name }}</span></div>
                <div>é¡å‹ï¼š<span class="font-medium">{{ 'é£²æ–™' if data.store.category == 'drink' else 'é¤é»' }}</span></div>
                {% if data.store.sugar_options %}
                <div>ç”œåº¦é¸é …ï¼š{{ data.store.sugar_options | join('ã€') }}</div>
                {% endif %}
                {% if data.store.ice_options %}
                <div>å†°å¡Šé¸é …ï¼š{{ data.store.ice_options | join('ã€') }}</div>
                {% endif %}
            </div>
        </div>
        {% else %}
        <div class="text-sm text-green-600 font-medium mb-2">ğŸ“‹ èœå–®åŒ¯å…¥</div>
        <div class="text-sm text-gray-600 mb-4">
            åº—å®¶ IDï¼š{{ data.store_id }}
            ãƒ»æ¨¡å¼ï¼š{{ 'æ–°å¢ç‰ˆæœ¬' if data.mode == 'new' else 'è¦†è“‹ç¾æœ‰' }}
        </div>
        {% endif %}
        
        <!-- èœå–®å…§å®¹ -->
        <div class="border rounded-lg p-3">
            <h3 class="font-medium text-gray-800 mb-2">èœå–®å…§å®¹</h3>
            
            {% if data.menu.categories %}
            {% for category in data.menu.categories %}
            <div class="mb-3">
                <div class="text-sm font-medium text-gray-700">{{ category.name }}</div>
                <div class="ml-4 text-sm text-gray-600">
                    {% for item in category.items %}
                    <div class="flex items-center gap-2 py-1">
                        <span>{{ item.name }}</span>
                        <span class="text-indigo-600">${{ item.price }}</span>
                        {% if item.options %}
                        <span class="text-xs text-gray-400">
                            ({% for opt in item.options %}{{ opt.name }}{% if opt.price_diff > 0 %}+${{ opt.price_diff }}{% endif %}{% if not loop.last %}ã€{% endif %}{% endfor %})
                        </span>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
            {% endif %}
            
            {% if data.menu.items %}
            <div class="text-sm text-gray-600">
                {% for item in data.menu.items %}
                <div class="flex items-center gap-2 py-1">
                    <span>{{ item.name }}</span>
                    <span class="text-indigo-600">${{ item.price }}</span>
                    {% if item.options %}
                    <span class="text-xs text-gray-400">
                        ({% for opt in item.options %}{{ opt.name }}{% if opt.price_diff > 0 %}+${{ opt.price_diff }}{% endif %}{% if not loop.last %}ã€{% endif %}{% endfor %})
                    </span>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- ç¢ºèªåŒ¯å…¥ -->
    <form action="/admin/import" method="post">
        <input type="hidden" name="json_str" value="{{ json_str | e }}">
        
        <div class="flex gap-2">
            <a href="/admin/import" class="flex-1 py-3 text-center rounded-lg border hover:bg-gray-50">
                å–æ¶ˆ
            </a>
            <button type="submit" class="flex-1 py-3 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white font-medium">
                ç¢ºèªåŒ¯å…¥
            </button>
        </div>
    </form>
</div>
{% endblock %}
