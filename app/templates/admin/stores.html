{% extends "base.html" %}

{% block title %}åº—å®¶ç®¡ç† - SELA å¿«é»ä¾†é»é¤{% endblock %}

{% block content %}
<div class="space-y-4" x-data="{ filter: 'all' }">
    <!-- Header -->
    <div class="flex items-center justify-between">
        <h1 class="text-xl font-bold text-gray-800">åº—å®¶ç®¡ç†</h1>
        <div class="flex items-center gap-3">
            <a href="/admin/import" class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium">
                + åŒ¯å…¥
            </a>
            <a href="/admin" class="text-sm text-gray-500 hover:text-gray-700">è¿”å›ç®¡ç†å¾Œå° â†’</a>
        </div>
    </div>
    
    <!-- åˆ†é¡ç¯©é¸ -->
    <div class="flex gap-2 overflow-x-auto pb-1">
        <button @click="filter = 'all'" 
                :class="filter === 'all' ? 'bg-orange-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'"
                class="px-4 py-2 rounded-full text-sm font-medium transition whitespace-nowrap">
            å…¨éƒ¨ ({{ stores|length }})
        </button>
        <button @click="filter = 'drink'" 
                :class="filter === 'drink' ? 'bg-amber-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'"
                class="px-4 py-2 rounded-full text-sm font-medium transition whitespace-nowrap">
            ğŸ§‹ é£²æ–™åº—
        </button>
        <button @click="filter = 'meal'" 
                :class="filter === 'meal' ? 'bg-green-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'"
                class="px-4 py-2 rounded-full text-sm font-medium transition whitespace-nowrap">
            ğŸ± é¤å»³
        </button>
        <button @click="filter = 'group_buy'" 
                :class="filter === 'group_buy' ? 'bg-blue-500 text-white' : 'bg-white text-gray-600 hover:bg-gray-50'"
                class="px-4 py-2 rounded-full text-sm font-medium transition whitespace-nowrap">
            ğŸ›’ åœ˜è³¼
        </button>
    </div>
    
    {% if stores %}
    <!-- å¡ç‰‡ç¶²æ ¼ -->
    <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
        {% for store in stores %}
        <a href="/admin/stores/{{ store.id }}"
           class="block bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition group"
           x-show="filter === 'all' || filter === '{{ store.category.value if store.category else 'meal' }}'">
            
            <!-- Logo å€åŸŸ -->
            <div class="aspect-square bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center relative">
                {% if store.logo_url %}
                <img src="{{ store.logo_url }}" alt="{{ store.name }}" 
                     class="w-full h-full object-contain p-4 group-hover:scale-105 transition">
                {% else %}
                <span class="text-5xl opacity-50">
                    {% if store.category and store.category.value == 'drink' %}ğŸ§‹
                    {% elif store.category and store.category.value == 'group_buy' %}ğŸ›’
                    {% else %}ğŸ±{% endif %}
                </span>
                {% endif %}
                
                <!-- ç‹€æ…‹æ¨™ç±¤ -->
                <div class="absolute top-2 right-2">
                    {% if store.is_active %}
                    <span class="text-xs bg-green-500 text-white px-2 py-0.5 rounded-full shadow">å•Ÿç”¨</span>
                    {% else %}
                    <span class="text-xs bg-gray-400 text-white px-2 py-0.5 rounded-full shadow">åœç”¨</span>
                    {% endif %}
                </div>
                
                <!-- é¡å‹æ¨™ç±¤ -->
                <div class="absolute top-2 left-2">
                    <span class="text-xs bg-white/80 backdrop-blur px-2 py-0.5 rounded-full shadow-sm">
                        {% if store.category and store.category.value == 'drink' %}é£²æ–™
                        {% elif store.category and store.category.value == 'group_buy' %}åœ˜è³¼
                        {% else %}é¤å»³{% endif %}
                    </span>
                </div>
            </div>
            
            <!-- è³‡è¨Šå€åŸŸ -->
            <div class="p-3">
                <div class="font-semibold text-gray-800 truncate">{{ store.name }}</div>
                <div class="text-xs text-gray-400 mt-0.5">
                    {% if store.branches %}{{ store.branches|length }} é–“åˆ†åº—{% else %}ç„¡åˆ†åº—{% endif %}
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-16 bg-white rounded-xl">
        <div class="text-5xl mb-3">ğŸª</div>
        <p class="text-gray-500 mb-4">é‚„æ²’æœ‰ä»»ä½•åº—å®¶</p>
        <a href="/admin/import" class="inline-block bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg">
            åŒ¯å…¥ç¬¬ä¸€é–“åº—å®¶
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
