{# ä¾¿åˆ©è²¼å¡ç‰‡ - ç”¨æ–¼é¦–é é¡¯ç¤ºåœ˜å–® #}
{% set bg_color = 'bg-amber-50' if group.category.value == 'drink' else ('bg-green-50' if group.category.value == 'meal' else 'bg-blue-50') %}
{% set tape_color = 'bg-amber-300/80' if group.category.value == 'drink' else ('bg-green-300/80' if group.category.value == 'meal' else 'bg-blue-300/80') %}
{% set note_color = 'text-amber-700' if group.category.value == 'drink' else ('text-green-700' if group.category.value == 'meal' else 'text-blue-700') %}
{% set border_color = 'border-amber-200' if group.category.value == 'drink' else ('border-green-200' if group.category.value == 'meal' else 'border-blue-200') %}

<a href="/groups/{{ group.id }}" 
   class="block {{ bg_color }} rounded-sm p-3 shadow-md hover:shadow-lg transition-all duration-200 relative border {{ border_color }} hover:-translate-y-1"
   style="aspect-ratio: 1 / 1; min-width: 140px;">
    
    <!-- ä¾¿åˆ©è²¼é ‚éƒ¨è† å¸¶æ•ˆæœ -->
    <div class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 w-14 h-4 {{ tape_color }} rounded-sm shadow-sm"
         style="transform: translateX(-50%) translateY(-50%) rotate(-2deg);"></div>
    
    <!-- ç´™å¼µç´‹ç†æ•ˆæœ -->
    <div class="absolute inset-0 opacity-30 pointer-events-none" 
         style="background-image: repeating-linear-gradient(0deg, transparent, transparent 23px, rgba(0,0,0,0.03) 24px);"></div>
    
    <!-- Logo ç½®ä¸­æ”¾å¤§ -->
    <div class="flex justify-center mb-2">
        <div class="w-16 h-16 rounded-lg bg-white shadow-sm flex items-center justify-center overflow-hidden border border-gray-100">
            {% if group.store.logo_url %}
            <img src="{{ group.store.logo_url }}" 
                 alt="{{ group.store.name }}" 
                 class="w-14 h-14 object-contain">
            {% else %}
            <span class="text-3xl">
                {% if group.category.value == 'drink' %}ğŸ§‹
                {% elif group.category.value == 'meal' %}ğŸ±
                {% else %}ğŸ›’{% endif %}
            </span>
            {% endif %}
        </div>
    </div>
    
    <!-- åœ˜å + åº—å®¶ -->
    <div class="text-center mb-1">
        <div class="text-sm font-bold text-gray-800 truncate">{{ group.name }}</div>
        <div class="text-xs text-gray-500 truncate">{{ group.store.name }}</div>
    </div>
    
    <!-- åœ˜ä¸» -->
    <div class="text-xs text-gray-400 text-center">{{ group.owner.show_name }}</div>
    
    <!-- å‚™è¨»ï¼ˆç°¡çŸ­é¡¯ç¤ºï¼‰ -->
    {% if group.note %}
    <div class="text-xs {{ note_color }} mt-1 text-center line-clamp-1">ğŸ“ {{ group.note }}</div>
    {% endif %}
    
    <!-- åº•éƒ¨ï¼šè¨‚å–®çµ±è¨ˆ + æˆªæ­¢æ™‚é–“ -->
    <div class="absolute bottom-2 left-2 right-2 flex items-center justify-between">
        <!-- è¨‚å–®çµ±è¨ˆ -->
        <div class="flex items-center gap-1.5 text-xs">
            {% if group.submitted_count > 0 %}
            <span class="text-green-600 font-medium" title="å·²çµå–®">âœ“{{ group.submitted_count }}</span>
            {% endif %}
            {% if group.pending_count > 0 %}
            <span class="text-orange-500" title="é»é¤ä¸­">ğŸ›’{{ group.pending_count }}</span>
            {% endif %}
            {% if group.submitted_count == 0 and group.pending_count == 0 %}
            <span class="text-gray-400 text-[10px]">å°šç„¡è¨‚å–®</span>
            {% endif %}
        </div>
        
        <!-- æˆªæ­¢æ™‚é–“ -->
        {% if group.is_open %}
        <span class="text-xs text-orange-600 font-bold"
              x-data="countdown('{{ group.deadline.isoformat() }}')"
              x-text="display"></span>
        {% else %}
        <span class="text-xs text-gray-400">å·²æˆªæ­¢</span>
        {% endif %}
    </div>
    
    <!-- å³ä¸‹è§’æ²æ›²æ•ˆæœ -->
    <div class="absolute bottom-0 right-0 w-4 h-4 pointer-events-none"
         style="background: linear-gradient(135deg, transparent 50%, rgba(0,0,0,0.05) 50%);"></div>
</a>
