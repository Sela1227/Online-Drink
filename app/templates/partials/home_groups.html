<div class="space-y-6">
    <!-- å…¬å‘Š -->
    {% if announcement %}
    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4">
        <div class="flex items-start gap-2">
            <span class="text-xl">ğŸ“¢</span>
            <div class="flex-1">
                <div class="font-medium text-blue-800 mb-1">å…¬å‘Š</div>
                <div class="text-sm text-blue-700 whitespace-pre-line">{{ announcement }}</div>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- è¶…å¤¯æ¸…å–® -->
    {% if hot_items %}
    <section x-data="{ showHot: false }">
        <h2 class="text-lg font-semibold text-gray-800 mb-3 cursor-pointer flex items-center gap-2" @click="showHot = !showHot">
            <span x-text="showHot ? 'â–¼' : 'â–¶'" class="text-xs"></span>
            ğŸ”¥ è¶…å¤¯æ¸…å–® <span class="text-sm font-normal text-gray-500">ï¼ˆæœ€è¿‘ 30 å¤©ï¼‰</span>
        </h2>
        <div x-show="showHot" x-collapse>
            <div class="bg-gradient-to-r from-orange-50 to-amber-50 rounded-lg p-4">
                <div class="space-y-2">
                    {% for item in hot_items %}
                    <div class="flex items-center gap-3 bg-white/80 rounded-lg px-3 py-2">
                        <div class="text-lg font-bold text-orange-500 w-6">{{ loop.index }}</div>
                        {% if item.store_logo %}
                        <img src="{{ item.store_logo }}" class="w-8 h-8 rounded object-contain bg-white">
                        {% endif %}
                        <div class="flex-1 min-w-0">
                            <div class="font-medium text-gray-800 truncate">{{ item.item_name }}</div>
                            <div class="text-xs text-gray-500">{{ item.store_name }}</div>
                        </div>
                        <div class="text-sm text-orange-600 font-medium">{{ item.total_qty|int }} æ¯</div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </section>
    {% endif %}
    
    <!-- è¨‚é£²æ–™ -->
    {% if drink_groups %}
    <section>
        <h2 class="text-lg font-semibold text-gray-800 mb-3">ğŸ§‹ è¨‚é£²æ–™ <span class="text-sm font-normal text-gray-500">({{ drink_groups|length }})</span></h2>
        <div class="grid grid-cols-2 gap-4 pt-2">
            {% for group in drink_groups %}
            {% include "partials/group_card.html" with context %}
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- è¨‚é¤ -->
    {% if meal_groups %}
    <section>
        <h2 class="text-lg font-semibold text-gray-800 mb-3">ğŸ± è¨‚é¤ <span class="text-sm font-normal text-gray-500">({{ meal_groups|length }})</span></h2>
        <div class="grid grid-cols-2 gap-4 pt-2">
            {% for group in meal_groups %}
            {% include "partials/group_card.html" with context %}
            {% endfor %}
        </div>
    </section>
    {% endif %}
    
    <!-- åœ˜è³¼ -->
    {% if groupbuy_groups %}
    <section>
        <h2 class="text-lg font-semibold text-gray-800 mb-3">ğŸ›’ åœ˜è³¼ <span class="text-sm font-normal text-gray-500">({{ groupbuy_groups|length }})</span></h2>
        <div class="grid grid-cols-2 gap-4 pt-2">
            {% for group in groupbuy_groups %}
            {% include "partials/group_card.html" with context %}
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- ç„¡é–‹æ”¾ä¸­çš„åœ˜ -->
    {% if not drink_groups and not meal_groups and not groupbuy_groups %}
    <div class="text-center py-12 text-gray-500">
        <p>ç›®å‰æ²’æœ‰é–‹æ”¾ä¸­çš„åœ˜</p>
        <p class="text-sm mt-1">é»æ“Šä¸Šæ–¹ã€Œé–‹åœ˜ã€æŒ‰éˆ•é–‹æ–°åœ˜ï¼</p>
    </div>
    {% endif %}

    <!-- å·²æˆªæ­¢ -->
    {% if closed_groups %}
    <section x-data="{ showClosed: false }">
        <h2 class="text-lg font-semibold text-gray-400 mb-3 cursor-pointer flex items-center gap-2" @click="showClosed = !showClosed">
            <span x-text="showClosed ? 'â–¼' : 'â–¶'" class="text-xs"></span>
            å·²æˆªæ­¢ <span class="text-sm font-normal">({{ closed_groups|length }})</span>
        </h2>
        <div x-show="showClosed" x-collapse>
            <div class="grid grid-cols-2 gap-4 pt-2">
                {% for group in closed_groups %}
                <div class="block bg-gray-100 rounded-sm p-3 shadow relative opacity-60 border border-gray-200"
                     style="aspect-ratio: 1 / 1; min-width: 140px;">
                    <!-- è† å¸¶ -->
                    <div class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 w-14 h-4 bg-gray-300/80 rounded-sm shadow-sm"></div>
                    
                    <!-- Logo -->
                    <a href="/groups/{{ group.id }}" class="block">
                        <div class="flex justify-center mb-2">
                            <div class="w-16 h-16 rounded-lg bg-white shadow-sm flex items-center justify-center overflow-hidden border border-gray-100">
                                {% if group.store.logo_url %}
                                <img src="{{ group.store.logo_url }}" class="w-14 h-14 object-contain">
                                {% else %}
                                <span class="text-3xl">
                                    {% if group.category.value == 'drink' %}ğŸ§‹
                                    {% elif group.category.value == 'meal' %}ğŸ±
                                    {% else %}ğŸ›’{% endif %}
                                </span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="text-center">
                            <div class="text-sm font-bold text-gray-600 truncate">{{ group.name }}</div>
                            <div class="text-xs text-gray-400 truncate">{{ group.store.name }}</div>
                        </div>
                        <div class="text-xs text-gray-400 text-center mt-1">{{ group.owner.show_name }}</div>
                        <div class="absolute bottom-2 left-2 right-2 text-center">
                            <span class="text-xs text-gray-400">å·²æˆªæ­¢</span>
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>
            <a href="/history" class="block text-center text-sm text-gray-500 mt-4 py-2 hover:text-orange-500">
                æŸ¥çœ‹å…¨éƒ¨æ­·å² â†’
            </a>
        </div>
    </section>
    {% endif %}
    
    <!-- åº—å®¶åå–® -->
    {% if stores %}
    <section x-data="{ showStores: false, filter: 'all' }">
        <h2 class="text-lg font-semibold text-gray-800 mb-3 cursor-pointer flex items-center gap-2" @click="showStores = !showStores">
            <span x-text="showStores ? 'â–¼' : 'â–¶'" class="text-xs"></span>
            ğŸª åº—å®¶åå–® <span class="text-sm font-normal text-gray-500">({{ stores|length }})</span>
        </h2>
        <div x-show="showStores" x-collapse>
            <!-- åˆ†é¡ç¯©é¸ -->
            <div class="flex gap-2 mb-3 overflow-x-auto pb-1">
                <button @click="filter = 'all'" 
                        :class="filter === 'all' ? 'bg-orange-500 text-white' : 'bg-white text-gray-600'"
                        class="px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap">
                    å…¨éƒ¨
                </button>
                <button @click="filter = 'drink'" 
                        :class="filter === 'drink' ? 'bg-amber-500 text-white' : 'bg-white text-gray-600'"
                        class="px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap">
                    ğŸ§‹ é£²æ–™
                </button>
                <button @click="filter = 'meal'" 
                        :class="filter === 'meal' ? 'bg-green-500 text-white' : 'bg-white text-gray-600'"
                        class="px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap">
                    ğŸ± é¤å»³
                </button>
                <button @click="filter = 'group_buy'" 
                        :class="filter === 'group_buy' ? 'bg-blue-500 text-white' : 'bg-white text-gray-600'"
                        class="px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap">
                    ğŸ›’ åœ˜è³¼
                </button>
            </div>
            
            <!-- åº—å®¶ç¶²æ ¼ -->
            <div class="grid grid-cols-3 sm:grid-cols-4 gap-2">
                {% for store in stores %}
                <a href="/stores/{{ store.id }}"
                   class="block bg-white rounded-lg shadow-sm p-2 hover:shadow-md transition text-center"
                   x-show="filter === 'all' || filter === '{{ store.category.value if store.category else 'meal' }}'">
                    <div class="w-12 h-12 mx-auto bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg flex items-center justify-center overflow-hidden mb-1">
                        {% if store.logo_url %}
                        <img src="{{ store.logo_url }}" alt="{{ store.name }}" class="w-full h-full object-contain p-1">
                        {% else %}
                        <span class="text-2xl">
                            {% if store.category and store.category.value == 'drink' %}ğŸ§‹
                            {% elif store.category and store.category.value == 'group_buy' %}ğŸ›’
                            {% else %}ğŸ±{% endif %}
                        </span>
                        {% endif %}
                    </div>
                    <div class="text-xs font-medium text-gray-700 truncate">{{ store.name }}</div>
                </a>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}
</div>
