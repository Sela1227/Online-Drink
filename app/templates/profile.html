{% extends "base.html" %}

{% block title %}å€‹äººè³‡æ–™ - SELA å¿«é»ä¾†é»é¤{% endblock %}

{% block content %}
<div class="space-y-4">
    <!-- æ¨™é¡Œåˆ— -->
    <div class="flex items-center justify-between">
        <h1 class="text-xl font-bold text-gray-800">å€‹äººè³‡æ–™</h1>
        <a href="/home" class="text-sm text-gray-500 hover:text-gray-700">â† è¿”å›é¦–é </a>
    </div>
    
    {% if request.query_params.get('success') %}
    <div class="bg-green-50 text-green-700 px-4 py-3 rounded-lg">
        âœ… è³‡æ–™å·²æ›´æ–°
    </div>
    {% endif %}
    
    <!-- å€‹äººè³‡è¨Šå¡ç‰‡ -->
    <div class="bg-white rounded-lg shadow-sm p-4">
        <div class="flex items-center gap-4 mb-6">
            {% if user.picture_url %}
            <img src="{{ user.picture_url }}" alt="{{ user.display_name }}" 
                 class="w-20 h-20 rounded-full">
            {% else %}
            <div class="w-20 h-20 rounded-full bg-orange-100 flex items-center justify-center text-2xl">
                ğŸ‘¤
            </div>
            {% endif %}
            <div>
                <div class="text-lg font-bold text-gray-800">{{ user.show_name }}</div>
                {% if user.nickname %}
                <div class="text-sm text-gray-500">LINE: {{ user.display_name }}</div>
                {% endif %}
                {% if user.is_admin %}
                <span class="text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded mt-1 inline-block">ç®¡ç†å“¡</span>
                {% endif %}
            </div>
        </div>
        
        <!-- çµ±è¨ˆ -->
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-gray-50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold text-orange-600">{{ order_count }}</div>
                <div class="text-xs text-gray-500">åƒèˆ‡è¨‚å–®</div>
            </div>
            <div class="bg-gray-50 rounded-lg p-3 text-center">
                <div class="text-2xl font-bold text-orange-600">{{ group_count }}</div>
                <div class="text-xs text-gray-500">é–‹éçš„åœ˜</div>
            </div>
        </div>
        
        <!-- ç·¨è¼¯è¡¨å–® -->
        <form action="/profile" method="post" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    ç³»çµ±é¡¯ç¤ºåç¨±
                    <span class="text-gray-400 font-normal">ï¼ˆç•™ç©ºå‰‡ä½¿ç”¨ LINE åç¨±ï¼‰</span>
                </label>
                <input type="text" name="nickname" 
                       value="{{ user.nickname or '' }}"
                       placeholder="{{ user.display_name }}"
                       class="w-full border rounded-lg px-3 py-2">
                <p class="text-xs text-gray-400 mt-1">æ­¤åç¨±æœƒé¡¯ç¤ºåœ¨è¨‚å–®ç‰†å’Œåœ˜å–®ä¸­</p>
            </div>
            
            <button type="submit" 
                    class="w-full py-3 rounded-lg bg-orange-500 hover:bg-orange-600 text-white font-medium">
                å„²å­˜è®Šæ›´
            </button>
        </form>
    </div>
    
    <!-- å¸³è™Ÿè³‡è¨Š -->
    <div class="bg-white rounded-lg shadow-sm p-4">
        <h2 class="font-semibold text-gray-800 mb-3">å¸³è™Ÿè³‡è¨Š</h2>
        <div class="space-y-2 text-sm">
            <div class="flex justify-between">
                <span class="text-gray-500">è¨»å†Šæ™‚é–“</span>
                <span class="text-gray-700">{{ (user.created_at|taipei).strftime('%Y-%m-%d %H:%M') }}</span>
            </div>
            {% if user.last_login_at %}
            <div class="flex justify-between">
                <span class="text-gray-500">ä¸Šæ¬¡ç™»å…¥</span>
                <span class="text-gray-700">{{ (user.last_login_at|taipei).strftime('%Y-%m-%d %H:%M') }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- å¿«æ·é€£çµ -->
    <div class="bg-white rounded-lg shadow-sm divide-y">
        <a href="/my-orders" class="flex items-center justify-between p-4 hover:bg-gray-50">
            <span class="font-medium">ğŸ“‹ æˆ‘çš„è¨‚å–®</span>
            <span class="text-gray-400">â†’</span>
        </a>
        <a href="/my/groups" class="flex items-center justify-between p-4 hover:bg-gray-50">
            <span class="font-medium">ğŸ“‚ æˆ‘åƒèˆ‡éçš„åœ˜</span>
            <span class="text-gray-400">â†’</span>
        </a>
        <a href="/templates" class="flex items-center justify-between p-4 hover:bg-gray-50">
            <span class="font-medium">âš¡ é–‹åœ˜æ¨¡æ¿</span>
            <span class="text-gray-400">â†’</span>
        </a>
        <a href="/my-departments" class="flex items-center justify-between p-4 hover:bg-gray-50">
            <span class="font-medium">ğŸ‘¥ æˆ‘çš„éƒ¨é–€</span>
            <span class="text-gray-400">â†’</span>
        </a>
        <a href="/favorites" class="flex items-center justify-between p-4 hover:bg-gray-50">
            <span class="font-medium">â­ æ”¶è—åº—å®¶</span>
            <span class="text-gray-400">â†’</span>
        </a>
        <a href="/auth/logout" class="flex items-center justify-between p-4 hover:bg-gray-50 text-red-500">
            <span class="font-medium">ç™»å‡º</span>
            <span class="text-gray-400">â†’</span>
        </a>
    </div>
</div>
{% endblock %}
