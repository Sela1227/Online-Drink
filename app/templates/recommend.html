{% extends "base.html" %}

{% block title %}æˆ‘æƒ³è¦æ¨è–¦åº—å®¶ - SELA å¿«é»ä¾†é»é¤{% endblock %}

{% block content %}
<div class="space-y-4">
    <!-- æ¨™é¡Œåˆ— -->
    <div class="flex items-center justify-between">
        <h1 class="text-xl font-bold text-gray-800">ğŸ’¡ æˆ‘æƒ³è¦æ¨è–¦åº—å®¶</h1>
        <a href="/home" class="text-sm text-gray-500 hover:text-gray-700">è¿”å›é¦–é  â†’</a>
    </div>
    
    <!-- æˆåŠŸè¨Šæ¯ -->
    {% if request.query_params.get('success') %}
    <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-green-700 text-sm">
        âœ… æ¨è–¦å·²é€å‡ºï¼ç®¡ç†å“¡å¯©æ ¸å¾Œæœƒé€šçŸ¥æ‚¨ã€‚
    </div>
    {% endif %}
    
    <!-- æ¨è–¦è¡¨å–® -->
    <div class="bg-white rounded-lg shadow-sm p-4">
        <h2 class="font-medium text-gray-800 mb-3">ğŸ“ æ¨è–¦æ–°åº—å®¶</h2>
        <p class="text-sm text-gray-500 mb-4">ç™¼ç¾å¥½åƒçš„åº—å®¶ï¼Ÿæ¨è–¦çµ¦å¤§å®¶ä¸€èµ·è¨‚ï¼</p>
        
        <form action="/recommend" method="POST" enctype="multipart/form-data" class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">åº—å®¶åç¨± <span class="text-red-500">*</span></label>
                <input type="text" name="store_name" required placeholder="ä¾‹å¦‚ï¼š50åµã€éº¥ç•¶å‹"
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">åº—å®¶é¡å‹ <span class="text-red-500">*</span></label>
                <select name="category" required
                        class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                    <option value="">è«‹é¸æ“‡</option>
                    <option value="drink">ğŸ§‹ é£²æ–™åº—</option>
                    <option value="meal">ğŸ± é¤å»³</option>
                    <option value="group_buy">ğŸ›’ åœ˜è³¼</option>
                </select>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">èœå–®é€£çµï¼ˆé¸å¡«ï¼‰</label>
                <input type="url" name="menu_url" placeholder="https://..."
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                <p class="text-xs text-gray-400 mt-1">å¯è²¼ä¸Šå®˜ç¶²ã€Uber Eatsã€foodpanda ç­‰èœå–®é€£çµ</p>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">èœå–®åœ–ç‰‡ï¼ˆé¸å¡«ï¼‰</label>
                <input type="file" name="menu_image" accept="image/*"
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm file:mr-3 file:py-1 file:px-3 file:rounded file:border-0 file:text-sm file:bg-orange-50 file:text-orange-600">
                <p class="text-xs text-gray-400 mt-1">å¯æ‹ç…§æˆ–ä¸Šå‚³èœå–®åœ–ç‰‡</p>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">å‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
                <textarea name="note" rows="2" placeholder="ä¾‹å¦‚ï¼šæ¨è–¦ä»–å€‘çš„çç å¥¶èŒ¶ï¼"
                          class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent"></textarea>
            </div>
            
            <button type="submit" class="w-full bg-orange-500 text-white px-4 py-3 rounded-lg font-medium hover:bg-orange-600">
                ğŸš€ é€å‡ºæ¨è–¦
            </button>
        </form>
    </div>
    
    <!-- æˆ‘çš„æ¨è–¦ç´€éŒ„ -->
    {% if recommendations %}
    <div class="bg-white rounded-lg shadow-sm">
        <div class="p-4 border-b">
            <h2 class="font-medium text-gray-800">ğŸ“‹ æˆ‘çš„æ¨è–¦ç´€éŒ„</h2>
        </div>
        <div class="divide-y">
            {% for rec in recommendations %}
            <div class="p-4">
                <div class="flex items-start justify-between gap-3">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="font-medium text-gray-800">{{ rec.store_name }}</span>
                            <span class="text-xs px-1.5 py-0.5 rounded
                                {% if rec.category == 'drink' %}bg-amber-100 text-amber-600
                                {% elif rec.category == 'meal' %}bg-green-100 text-green-600
                                {% else %}bg-blue-100 text-blue-600{% endif %}">
                                {% if rec.category == 'drink' %}ğŸ§‹ é£²æ–™
                                {% elif rec.category == 'meal' %}ğŸ± é¤å»³
                                {% else %}ğŸ›’ åœ˜è³¼{% endif %}
                            </span>
                        </div>
                        {% if rec.note %}
                        <div class="text-sm text-gray-500">{{ rec.note }}</div>
                        {% endif %}
                        <div class="text-xs text-gray-400 mt-1">
                            {{ rec.created_at.strftime('%Y/%m/%d %H:%M') }}
                        </div>
                    </div>
                    <div class="flex-shrink-0">
                        {% if rec.status == 'pending' %}
                        <span class="text-xs px-2 py-1 rounded-full bg-yellow-100 text-yellow-700">â³ å¯©æ ¸ä¸­</span>
                        {% elif rec.status == 'approved' %}
                        <span class="text-xs px-2 py-1 rounded-full bg-green-100 text-green-700">âœ… å·²é€šé</span>
                        {% else %}
                        <span class="text-xs px-2 py-1 rounded-full bg-red-100 text-red-700">âŒ æœªé€šé</span>
                        {% endif %}
                    </div>
                </div>
                {% if rec.status == 'rejected' and rec.reject_reason %}
                <div class="mt-2 text-xs text-red-500 bg-red-50 rounded p-2">
                    åŸå› ï¼š{{ rec.reject_reason }}
                </div>
                {% endif %}
                {% if rec.status == 'approved' and rec.created_store_id %}
                <div class="mt-2">
                    <a href="/stores/{{ rec.created_store_id }}" class="text-xs text-orange-600 hover:underline">
                        æŸ¥çœ‹åº—å®¶ â†’
                    </a>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
